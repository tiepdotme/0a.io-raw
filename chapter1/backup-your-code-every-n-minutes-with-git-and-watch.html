<!doctype html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
                <link rel="apple-touch-icon" sizes="57x57" href="../img/favicons/apple-icon-57x57.png">
                <link rel="apple-touch-icon" sizes="60x60" href="../img/favicons/apple-icon-60x60.png">
                <link rel="apple-touch-icon" sizes="72x72" href="../img/favicons/apple-icon-72x72.png">
                <link rel="apple-touch-icon" sizes="76x76" href="../img/favicons/apple-icon-76x76.png">
                <link rel="apple-touch-icon" sizes="114x114" href="../img/favicons/apple-icon-114x114.png">
                <link rel="apple-touch-icon" sizes="120x120" href="../img/favicons/apple-icon-120x120.png">
                <link rel="apple-touch-icon" sizes="144x144" href="../img/favicons/apple-icon-144x144.png">
                <link rel="apple-touch-icon" sizes="152x152" href="../img/favicons/apple-icon-152x152.png">
                <link rel="apple-touch-icon" sizes="180x180" href="../img/favicons/apple-icon-180x180.png">
                <link rel="icon" type="image/png" sizes="192x192" href="../img/favicons/android-icon-192x192.png">
                <link rel="icon" type="image/png" sizes="32x32" href="../img/favicons/favicon-32x32.png">
                <link rel="icon" type="image/png" sizes="96x96" href="../img/favicons/favicon-96x96.png">
                <link rel="icon" type="image/png" sizes="16x16" href="../img/favicons/favicon-16x16.png">
                <link rel="manifest" href="../img/favicons/manifest.json">
                <meta name="msapplication-TileColor" content="#ffffff">
                <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
                <meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="../css/bootstrap.4.0.0-beta3.min.css" />
<link href="../css/ionicons.2.0.1.min.css" rel="stylesheet">
<link href="../css/main.css" rel="stylesheet">
<link href="../css/fonts.css" rel="stylesheet">

<meta property="og:url" content="http://zer0.degree//chapter1/backup-your-code-every-n-minutes-with-git-and-watch.html" />

<meta property="og:type" content="article" />


<meta property="og:title" content="Making backup for each line of code in your project every n minutes in case your code editor decides to revert some file back to its state x hours ago" />


<meta property="og:image" content="http://zer0.degree/img/covers/The Dog, 1819~1823, Francisco Goya.jpg" />

<title> Making backup for each line of code in your project every n minutes in case your code editor decides to revert some file back to its state x hours ago - Zer0 Degree, The Website of Archy Wilhes 魏何</title>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?class=UA-112409544-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-112409544-1');
</script>
<script src="../js/main.js"></script>

  </head>
  <body><div id="body-wrapper"><div id="body">
    <div class="cover-image">
    <img class="hide-if-smaller-than-mobile-device-regular" src="../img/backgrounds/willian-justen-de-vasconcellos-430007.jpg" />
    <img class="show-if-smaller-than-mobile-device-regular" src="../img/backgrounds/willian-justen-de-vasconcellos-430007-full.jpg" />
    <div class="cover-image-text-wrapper">
    <div class="cover-image-text">
      <h1 class="zeroDegreeLogo centerFlex">
        <div><a href="../">Zer0<br />Degree</a></div><div><sup class="degreeDot">o</sup><br />&nbsp;</div>
      </h1>

      <div class="zeroDegreeNameAndDescription hide-if-smaller-than-mobile-device-large-but-flex" style="margin-left:20px">
      <h2 class="zeroDegreeName">
        The Website of <br /><a href="../about.html">Archy Wilhes 魏何</a>
        <a target="_blank" href="http://twitter.com/archywilhes"><i class="social-icon ion-social-twitter"></i></a>
        <a target="_blank" href="http://github.com/archywilhes"><i class="social-icon ion-social-octocat"></i></a>
        <a target="_blank" href="http://instagram.com/archywilhes"><i class="social-icon ion-social-instagram"></i></a>
        <a target="_blank" href="http://archy.sh"><i class="social-icon ion-erlenmeyer-flask"></i></a>
      </h2>
      <div class="zeroDegreeDescription">a comp sci fanatic in his early twenties doing start-up stuff<br />
        (on and off since the age of sixteen) instead of going to univ</div>
      </div>
    </div>
    <h2 class="stayCool thickRaleway hide-if-smaller-than-mobile-device-large">
      Stay cool.
    </h2>
    <h3 class="stayCool thickRaleway show-iff-mobile-device-large">
      The Website of<br /> <a href="../about.html">Archy Wilhes 魏何</a>
  </h3>
  <h2 class="stayCool thickRaleway show-if-smaller-than-mobile-device-medium">
    <a href="../about-zer0-degree.html">About</a>
  </h2>
    </div>
  </div>

  
<div class="hide-if-bigger-than-mobile-device-regular">
  <h2 class="thickRaleway menu">
    <!-- <a href="/" class="menu-item">Back to Home Page</a> -->
</h2>
</div>
<div class="container content">
<article style>
    <div class="coverPainting">
        <img src="../img/covers/The Dog, 1819~1823, Francisco Goya.jpg" />
    </div>
    <div class="everythingElse">
        <div class="info">
            <i class="ion-calendar"></i>
            <span class="date">03 Jul 2015</span>
            
        </div>
        <h2 class="title">
            Making backup for each line of code in your project every n minutes in case your code editor decides to revert some file back to its state x hours ago
        </h2>
        <div class="text">
            <p>I just reinstalled my OS X recently, which not only enabled me to re-experience the joy of owning a new Mac, but also fixed problems like waking up into a partially slumber stage with a black screen and a movable cursor that is practically useless. Since I was going to <a href="http://stackoverflow.com/questions/27381531/how-to-install-sublime-text-3-using-homebrew"><code>brew cask install</code></a> a brand new <a href="http://www.sublimetext.com/">Sublime Text Editor</a>, I decided to spend a bit more effort customizing it. After some googling and experimentation, these are my settings:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb1-1" data-line-number="1"></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="fu">{</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">    <span class="dt">&quot;bold_folder_labels&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">    <span class="dt">&quot;caret_style&quot;</span><span class="fu">:</span> <span class="st">&quot;phase&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">    <span class="dt">&quot;color_scheme&quot;</span><span class="fu">:</span> <span class="st">&quot;Packages/Color Scheme - Default/Blackboard.tmTheme&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">    <span class="dt">&quot;draw_minimap_border&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">    <span class="dt">&quot;draw_white_space&quot;</span><span class="fu">:</span> <span class="st">&quot;all&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">    <span class="dt">&quot;ensure_newline_at_eof_on_save&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">    <span class="dt">&quot;fade_fold_buttons&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">    <span class="dt">&quot;find_selected_text&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">    <span class="dt">&quot;font_face&quot;</span><span class="fu">:</span> <span class="st">&quot;Source Code Pro Light&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">    <span class="dt">&quot;font_size&quot;</span><span class="fu">:</span> <span class="fl">14.0</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13">    <span class="dt">&quot;highlight_line&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14">    <span class="dt">&quot;ignored_packages&quot;</span><span class="fu">:</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15">    <span class="ot">[</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16">    <span class="ot">]</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17">    <span class="dt">&quot;letter-spacing-length&quot;</span><span class="fu">:</span> <span class="dv">20</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18">    <span class="dt">&quot;line_padding_bottom&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19">    <span class="dt">&quot;line_padding_top&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20">    <span class="dt">&quot;rulers&quot;</span><span class="fu">:</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21">    <span class="ot">[</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22">        <span class="dv">120</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23">    <span class="ot">]</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24">    <span class="dt">&quot;shift_tab_unindent&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25">    <span class="dt">&quot;spacegray_sidebar_font_normal&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26">    <span class="dt">&quot;spacegray_sidebar_tree_xlarge&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27">    <span class="dt">&quot;spacegray_tabs_auto_width&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28">    <span class="dt">&quot;spacegray_tabs_font_normal&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29">    <span class="dt">&quot;spacegray_tabs_large&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30">    <span class="dt">&quot;tab_size&quot;</span><span class="fu">:</span> <span class="dv">4</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31">    <span class="dt">&quot;theme&quot;</span><span class="fu">:</span> <span class="st">&quot;Spacegray.sublime-theme&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32">    <span class="dt">&quot;translate_tabs_to_spaces&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-33" data-line-number="33">    <span class="dt">&quot;trim_trailing_white_space_on_save&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-34" data-line-number="34">    <span class="dt">&quot;vintage_start_in_command_mode&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-35" data-line-number="35">    <span class="dt">&quot;word_separators&quot;</span><span class="fu">:</span> <span class="st">&quot;./</span><span class="ch">\\</span><span class="st">()</span><span class="ch">\&quot;</span><span class="st">'-:,.;&lt;&gt;~!@#$%^&amp;*|+=[]{}`~?_&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36">    <span class="dt">&quot;word_wrap&quot;</span><span class="fu">:</span> <span class="kw">true</span></a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="fu">}</span></a></code></pre></div>
<p>(For the record Source Code Pro can be grabbed <a href="https://github.com/adobe-fonts/source-code-pro">here</a>; Spacegray <a href="https://github.com/kkga/spacegray">here</a>; and Blackboard <a href="https://github.com/cfletcher1856/Theme-Blackboard">here</a>)</p>
<p class="text-center">
<img src="../img/from-chapter-1/sublime.png" alt="oh">
</p>
<p>This looked like a great environment to code in (I enabled <a href="http://www.sublimetext.com/docs/2/vintage.html">vintage mode</a> too so there are vim magic in it ;3 ) until I learnt that sometimes the text editor would revert some file back to its state x hours ago with no reason at all.</p>
<p>It is a nightmare. (Imagine happily committing your code only to learn all that you’ve written &amp; tested no longer exist in the current dimensions in space-time.)</p>
<p>I still don’t have a clue what is the cause. (I only have a few plug-ins installed. I don’t think the plug-ins have to do with it.) But it has happened quite a few times and I have had my losses. Until I figure out what’s causing the strange phenomenon and get it fixed, I need to start taking precaution.</p>
<p>Here is a simple system that uses <a href="http://linux.die.net/man/1/watch"><code>watch</code></a> with the help of <code>git</code> to make backup of every single file in a directory every 90 seconds:</p>
<blockquote>
<p><code>watch</code> can execute a line of code periodically in the terminal. The nice thing is that you can watch the outputs as it does.</p>
</blockquote>
<p>Let’s say this is the directory containing projects you want to back up</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="ex">/Users/a/_/_</span></a></code></pre></div>
<ol type="1">
<li>Make a directory to keep the back up files</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="fu">mkdir</span> /Users/a/_/timeMachine    #or any directory of your choice</a></code></pre></div>
<ol start="2" type="1">
<li>Make it into a git repo.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="bu">cd</span> /Users/a/_/timeMachine</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="fu">git</span> init    #this would create a .git folder in /Users/a/_/timeMachine</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">            <span class="co">#now /Users/a/_/timeMachine is a git repo</span></a></code></pre></div>
<ol start="3" type="1">
<li>Write a bash script that</li>
</ol>
<ol type="1">
<li>Copy everything in the directory to the backup directory</li>
<li>Remove all the <code>.git</code> folders from each project in the backup directory (The <code>.git</code> folder is what that determines a directory to be a git repo: removing it would turn git repo back to a normal directory. In order for <code>commit</code> to work, it is necessary to have every subdirectory as a non git repo. If not, the subdirectories containing <code>.git</code> will be treated as <a href="http://git-scm.com/docs/git-submodule">git submodules</a>.) <br> [Changes made in a git submodule can’t be committed as changes of the main git repo.]</li>
<li>Git add &amp; commit everything in the backup directory</li>
</ol>
<p>and save it as <code>script.sh</code>.(You can save it at anywhere you want)</p>
<p>Here is my <code>script.sh</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="bu">cd</span> /Users/a/_                       #replace this with the directory you want to back up</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="fu">cp</span> -rf _/* timeMachine              #replace this with the directory to back up to</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="fu">rm</span> -rf timeMachine/*/.git           #remove all .git folders in each project</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="bu">cd</span> timeMachine</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="fu">git</span> add .                           #add any changes</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="fu">git</span> commit -am <span class="st">&quot;</span><span class="kw">`</span><span class="fu">date</span> +%F-%T<span class="kw">`</span><span class="st">&quot;</span>      #commit to store the changes</a></code></pre></div>
<ol start="4" type="1">
<li>Simply run this script periodically using <code>watch</code> (You can install it with <a href="http://brew.sh/">brew</a> if you don’t have it).</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="ex">brew</span> install watch          #brew is a package manager for OSX. http://brew.sh/</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="ex">watch</span> -n 90 <span class="st">'bash script.sh'</span></a></code></pre></div>
<p>That’s it. Now every 90 seconds, the changes you made in your project (e.g. <code>/Users/a/_/0a-.github.com</code>) would be recorded in the backup directory. You can view changes of the file using <a href="http://git-scm.com/docs/git-log"><code>git log</code></a>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="bu">cd</span> /Users/a/_/timeMachine/0a-.github.com</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="fu">git</span> log -p myFile.js</a></code></pre></div>
<p>or do it in <a href="https://mac.github.com/">a GUI Client</a>. (They would show up in the Unsynced tab because all we are doing is just <a href="http://git-scm.com/docs/git-commit">committing</a> and there is no <a href="http://git-scm.com/docs/git-push">pushing</a> involved.)</p>
<p class="text-center">
<img src="../img/from-chapter-1/timeMachine.jpg" alt="such time much machine">
</p>
<p>The backup directory is going to take more and more disk space as time passes (as long as you remember to <code>watch -n 90 'bash script.sh'</code> before you start to code each time). When you want to clean everything up, simply remove everything (including the <code>.git</code> folder) and do a <code>git init</code> again.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="bu">cd</span> /Users/a/_/timeMachine   #replace it with your backup repo</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="fu">rm</span> -rf *        #this can be deadly if used unwisely</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="fu">git</span> init</a></code></pre></div>
<p>The great thing about using git is that only the changes of the files would be saved. So rather than having 10 backup copies of a project that are slightly different from one another, you’d only have one copy of it, and 9 indications of the different changes you made at different times.</p>
        </div>
    </div>
</article>
</div>
<div>
  <h2 class="thickRaleway menu-bottom">
    <a class="menu-item" href="../">Back to Home Page</a>
</h2>
</div>


  <div class="cover-image">
  <img class="hide-if-smaller-than-mobile-device-regular" src="../img/backgrounds/maarten-van-den-heuvel-346883.jpg" />
  <img class="show-if-smaller-than-mobile-device-regular" src="../img/backgrounds/maarten-van-den-heuvel-346883-full.jpg" />

  <div class="whiteOverlay"></div>
  <div class="cover-image-text-wrapper">
  <div class="cover-image-text">
    <h1 class="zeroDegreeLogo centerFlex hide-if-smaller-than-mobile-device-regular-but-flex">
        <div><a href="../">Zer0<br />Degree</a></div><div><sup class="degreeDot">o</sup><br />&nbsp;</div>
    </h1>
    <div class="show-if-smaller-than-mobile-device-regular">
    <div class="centerFlex footer-info-block">
        <div>
        <h5 class="hide-if-smaller-than-mobile-device-small">
            A Website of <a href="../about-zer0-degree.html">Archy Wilhes 魏何</a><br />
            Handcrafted by <a href="../about-zer0-degree.html">Archy Wilhes 魏何</a>
        </h5>
        <h5 class="show-if-smaller-than-mobile-device-small">
            A Website of<br />
            <a href="../about-zer0-degree.html">Archy Wilhes 魏何</a><br />

        </h5>
        <h3>
            <a target="_blank" href="http://twitter.com/archywilhes"><i class="social-icon ion-social-twitter"></i></a>
            <a target="_blank" href="http://github.com/archywilhes"><i class="social-icon ion-social-octocat"></i></a>
            <a target="_blank" href="http://instagram.com/archywilhes"><i class="social-icon ion-social-instagram"></i></a>
            <a target="_blank" href="http://archy.sh"><i class="social-icon ion-erlenmeyer-flask"></i></a>
        </h3>
        </div>
</div>
</div>
    <div class="zeroDegreeNameAndDescription hide-if-smaller-than-mobile-device-regular-but-flex" style="margin-left:20px">
    <h3 class="zeroDegreeName">
      Handcarfted by <a href="../about.html">Archy Wilhes 魏何</a><br />
      <a style="margin-left:7px" href="https://github.com/archywilhes/zer0.degree">
          <small>vi3w_s0urce <i class="ion-beer"></i></small>
      </a>
  </h3>
    <div class="zeroDegreeDescription">
        Frontend consists of vanilla JS, CSS & HTML with <a href="https://v4-alpha.getbootstrap.com/">Bootstrap</a>  <br />
         Backend written exclusively in Haskell using <a href="https://jaspervdj.be/hakyll/">Hakyll <i class="ion-heart"></a></i>
    </div>
    </div>
  </div>
  <h3 class="stayCool thickRaleway" style="color:rgba(0,0,0,0.9)">
        See you around.
  </h3>
  </div>
  </div>


</div></div>

</body>

</html>
